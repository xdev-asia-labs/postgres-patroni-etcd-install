;;;
;;; PgBouncer Configuration File
;;; Generated by Ansible - Do not edit manually
;;;

[databases]
; Wildcard for any database
* = host=127.0.0.1 port=5432

; Specific databases
postgres = host=127.0.0.1 port=5432
testdb = host=127.0.0.1 port=5432

[pgbouncer]
;;;
;;; Administrative Settings
;;;
logfile = /var/log/pgbouncer/pgbouncer.log
pidfile = /var/run/pgbouncer/pgbouncer.pid
listen_addr = {{ pgbouncer_listen_addr }}
listen_port = {{ pgbouncer_listen_port }}
unix_socket_dir = /var/run/postgresql
admin_users = postgres
stats_users = postgres

;;;
;;; Authentication Settings
;;;
auth_type = {{ pgbouncer_auth_type }}
auth_file = /etc/pgbouncer/userlist.txt

;;;
;;; Pooling Settings
;;;
pool_mode = {{ pgbouncer_pool_mode }}
max_client_conn = {{ pgbouncer_max_client_conn }}
default_pool_size = {{ pgbouncer_default_pool_size }}
min_pool_size = {{ pgbouncer_min_pool_size | default(5) }}
reserve_pool_size = {{ pgbouncer_reserve_pool_size | default(5) }}
reserve_pool_timeout = {{ pgbouncer_reserve_pool_timeout | default(3) }}
max_db_connections = {{ pgbouncer_max_db_connections | default(50) }}
max_user_connections = {{ pgbouncer_max_user_connections | default(50) }}

;;;
;;; Connection Limits
;;;
server_idle_timeout = {{ pgbouncer_server_idle_timeout | default(600) }}
server_connect_timeout = 15
server_login_retry = 15
client_idle_timeout = {{ pgbouncer_client_idle_timeout | default(0) }}
client_login_timeout = 60

;;;
;;; Low-level Network Settings
;;;
pkt_buf = 4096
listen_backlog = 128
sbuf_loopcnt = 5
max_packet_size = 2147483647

;;;
;;; Logging
;;;
log_connections = {{ pgbouncer_log_connections | default(0) }}
log_disconnections = {{ pgbouncer_log_disconnections | default(0) }}
log_pooler_errors = 1
stats_period = {{ pgbouncer_stats_period | default(60) }}

;;;
;;; Dangerous Timeouts
;;;
query_timeout = 0
query_wait_timeout = 120
cancel_wait_timeout = 10
idle_transaction_timeout = 0

;;;
;;; TLS Settings
;;;
;client_tls_sslmode = disable
;client_tls_ca_file = 
;client_tls_key_file = 
;client_tls_cert_file = 

;;;
;;; Miscellaneous
;;;
application_name_add_host = 0
ignore_startup_parameters = extra_float_digits
