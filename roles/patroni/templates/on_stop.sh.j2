#!/bin/bash
# Patroni callback script: on_stop
# Generated by Ansible - Do not edit manually
#
# This script is called when PostgreSQL is stopped

ACTION=$1
ROLE=$2
CLUSTER=$3
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
LOGFILE="{{ postgresql_data_dir }}/log/patroni_callbacks.log"
HOSTNAME=$(hostname)

# Log function
log() {
    echo "[$TIMESTAMP] [$HOSTNAME] [$ACTION] [$ROLE] $1" >> $LOGFILE
}

log "PostgreSQL stopped (was $ROLE)"

# Add your custom actions here

exit 0
